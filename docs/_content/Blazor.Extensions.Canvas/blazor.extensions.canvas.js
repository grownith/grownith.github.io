(()=>{"use strict";var t={833:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ContextManager=void 0,e.ContextManager=class{constructor(t){if(this.contexts=new Map,this.webGLObject=new Array,this.webGLContext=!1,this.webGLTypes=[WebGLBuffer,WebGLShader,WebGLProgram,WebGLFramebuffer,WebGLRenderbuffer,WebGLTexture,WebGLUniformLocation],this.add=(t,e)=>{if(!t)throw new Error("Invalid canvas.");if(!this.contexts.get(t.id)){var n;if(!(n=e?t.getContext(this.contextName,e):t.getContext(this.contextName)))throw new Error("Invalid context.");this.contexts.set(t.id,n)}},this.remove=t=>{this.contexts.delete(t.id)},this.setProperty=(t,e,n)=>{const i=this.getContext(t);this.setPropertyWithContext(i,e,n)},this.getProperty=(t,e)=>{const n=this.getContext(t);return this.serialize(n[e])},this.call=(t,e,n)=>{const i=this.getContext(t);return this.callWithContext(i,e,n)},this.callBatch=(t,e)=>{const n=this.getContext(t);for(let t=0;t<e.length;t++){let i=e[t].slice(2);e[t][1]?this.callWithContext(n,e[t][0],i):this.setPropertyWithContext(n,e[t][0],Array.isArray(i)&&i.length>0?i[0]:null)}},this.callWithContext=(t,e,n)=>this.serialize(this.prototypes[e].apply(t,null!=n?n.map((t=>this.deserialize(e,t))):[])),this.setPropertyWithContext=(t,e,n)=>{t[e]=this.deserialize(e,n)},this.getContext=t=>{if(!t)throw new Error("Invalid canvas.");const e=this.contexts.get(t.id);if(!e)throw new Error("Invalid context.");return e},this.deserialize=(t,e)=>{if(!this.webGLContext||null==e)return e;if(e.hasOwnProperty("webGLType")&&e.hasOwnProperty("id"))return this.webGLObject[e.id];if(Array.isArray(e)&&!t.endsWith("v"))return Int8Array.of(...e);if("string"!=typeof e||"bufferData"!==t&&"bufferSubData"!==t)return e;{let t=window.atob(e),i=t.length,r=new Uint8Array(i);for(var n=0;n<i;n++)r[n]=t.charCodeAt(n);return r}},this.serialize=t=>{if(t instanceof TextMetrics)return{width:t.width};if(!this.webGLContext||null==t)return t;const e=this.webGLTypes.find((e=>t instanceof e));if(null!=e){const n=this.webGLObject.length;return this.webGLObject.push(t),{webGLType:e.name,id:n}}return t},this.contextName=t,"2d"===t)this.prototypes=CanvasRenderingContext2D.prototype;else{if("webgl"!==t&&"experimental-webgl"!==t)throw new Error(`Invalid context name: ${t}`);this.prototypes=WebGLRenderingContext.prototype,this.webGLContext=!0}}}},783:(t,e,n)=>{const i=n(833);var r;!function(t){const e={Canvas2d:new i.ContextManager("2d"),WebGL:new i.ContextManager("webgl")};t.initialize=function(){"undefined"==typeof window||window.BlazorExtensions?window.BlazorExtensions=Object.assign(Object.assign({},window.BlazorExtensions),e):window.BlazorExtensions=Object.assign({},e)}}(r||(r={})),r.initialize()}},e={};!function n(i){if(e[i])return e[i].exports;var r=e[i]={exports:{}};return t[i](r,r.exports,n),r.exports}(783)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9ibGF6b3IuZXh0ZW5zaW9ucy5jYW52YXMvLi9zcmMvQ2FudmFzQ29udGV4dE1hbmFnZXIudHMiLCJ3ZWJwYWNrOi8vYmxhem9yLmV4dGVuc2lvbnMuY2FudmFzLy4vc3JjL0luaXRpYWxpemVDYW52YXMudHMiLCJ3ZWJwYWNrOi8vYmxhem9yLmV4dGVuc2lvbnMuY2FudmFzL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL2JsYXpvci5leHRlbnNpb25zLmNhbnZhcy93ZWJwYWNrL3N0YXJ0dXAiXSwibmFtZXMiOlsiY29udGV4dE5hbWUiLCJjb250ZXh0cyIsIk1hcCIsIndlYkdMT2JqZWN0IiwiQXJyYXkiLCJ3ZWJHTENvbnRleHQiLCJ3ZWJHTFR5cGVzIiwiV2ViR0xCdWZmZXIiLCJXZWJHTFNoYWRlciIsIldlYkdMUHJvZ3JhbSIsIldlYkdMRnJhbWVidWZmZXIiLCJXZWJHTFJlbmRlcmJ1ZmZlciIsIldlYkdMVGV4dHVyZSIsIldlYkdMVW5pZm9ybUxvY2F0aW9uIiwiYWRkIiwiY2FudmFzIiwicGFyYW1ldGVycyIsIkVycm9yIiwidGhpcyIsImdldCIsImlkIiwiY29udGV4dCIsImdldENvbnRleHQiLCJzZXQiLCJyZW1vdmUiLCJkZWxldGUiLCJzZXRQcm9wZXJ0eSIsInByb3BlcnR5IiwidmFsdWUiLCJzZXRQcm9wZXJ0eVdpdGhDb250ZXh0IiwiZ2V0UHJvcGVydHkiLCJzZXJpYWxpemUiLCJjYWxsIiwibWV0aG9kIiwiYXJncyIsImNhbGxXaXRoQ29udGV4dCIsImNhbGxCYXRjaCIsImJhdGNoZWRDYWxscyIsImkiLCJsZW5ndGgiLCJwYXJhbXMiLCJzbGljZSIsImlzQXJyYXkiLCJwcm90b3R5cGVzIiwiYXBwbHkiLCJ1bmRlZmluZWQiLCJtYXAiLCJkZXNlcmlhbGl6ZSIsIm9iamVjdCIsImhhc093blByb3BlcnR5IiwiZW5kc1dpdGgiLCJJbnQ4QXJyYXkiLCJvZiIsImJpblN0ciIsIndpbmRvdyIsImF0b2IiLCJieXRlcyIsIlVpbnQ4QXJyYXkiLCJjaGFyQ29kZUF0IiwiVGV4dE1ldHJpY3MiLCJ3aWR0aCIsInR5cGUiLCJmaW5kIiwicHVzaCIsIndlYkdMVHlwZSIsIm5hbWUiLCJDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQiLCJwcm90b3R5cGUiLCJXZWJHTFJlbmRlcmluZ0NvbnRleHQiLCJDYW52YXMiLCJleHRlbnNpb25PYmplY3QiLCJDYW52YXMyZCIsIkNvbnRleHRNYW5hZ2VyIiwiV2ViR0wiLCJpbml0aWFsaXplIiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iXSwibWFwcGluZ3MiOiIrR0FBQSx1QkFVRSxZQUFtQkEsR0FFakIsR0FYZSxLQUFBQyxTQUFXLElBQUlDLElBQ2YsS0FBQUMsWUFBYyxJQUFJQyxNQUUzQixLQUFBQyxjQUFlLEVBRU4sS0FBQUMsV0FBYSxDQUM1QkMsWUFBYUMsWUFBYUMsYUFBY0MsaUJBQWtCQyxrQkFBbUJDLGFBQWNDLHNCQWN0RixLQUFBQyxJQUFNLENBQUNDLEVBQTJCQyxLQUN2QyxJQUFLRCxFQUFRLE1BQU0sSUFBSUUsTUFBTSxtQkFDN0IsSUFBSUMsS0FBS2pCLFNBQVNrQixJQUFJSixFQUFPSyxJQUE3QixDQUVBLElBQUlDLEVBTUosS0FKRUEsRUFERUwsRUFDUUQsRUFBT08sV0FBV0osS0FBS2xCLFlBQWFnQixHQUVwQ0QsRUFBT08sV0FBV0osS0FBS2xCLGNBRXJCLE1BQU0sSUFBSWlCLE1BQU0sb0JBRTlCQyxLQUFLakIsU0FBU3NCLElBQUlSLEVBQU9LLEdBQUlDLEtBR3hCLEtBQUFHLE9BQVVULElBQ2ZHLEtBQUtqQixTQUFTd0IsT0FBT1YsRUFBT0ssS0FHdkIsS0FBQU0sWUFBYyxDQUFDWCxFQUEyQlksRUFBa0JDLEtBQ2pFLE1BQU1QLEVBQVVILEtBQUtJLFdBQVdQLEdBQ2hDRyxLQUFLVyx1QkFBdUJSLEVBQVNNLEVB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QjFCLGVBRUEsSUFBVWdFLEdBQVYsU0FBVUEsR0FDUixNQUVNQyxFQUFrQixDQUN0QkMsU0FBVSxJQUFJLEVBQUFDLGVBQWUsTUFDN0JDLE1BQU8sSUFBSSxFQUFBRCxlQUFlLFVBR1osRUFBQUUsV0FBaEIsV0FDd0Isb0JBQVhwQixRQUEyQkEsT0FBdUIsaUJBTzNEQSxPQUF1QixpQkFBSSxPQUFILHdCQUNuQkEsT0FBdUIsa0JBQ3ZCZ0IsR0FOTGhCLE9BQXVCLGlCQUFJLE9BQUgsVUFDbkJnQixJQWJYLENBQVVELE1BQU0sS0F3QmhCQSxFQUFPSyxlQ3pCSEMsRUFBMkIsSUFHL0IsU0FBU0MsRUFBb0JDLEdBRTVCLEdBQUdGLEVBQXlCRSxHQUMzQixPQUFPRixFQUF5QkUsR0FBVUMsUUFHM0MsSUFBSUMsRUFBU0osRUFBeUJFLEdBQVksQ0FHakRDLFFBQVMsSUFPVixPQUhBRSxFQUFvQkgsR0FBVUUsRUFBUUEsRUFBT0QsUUFBU0YsR0FHL0NHLEVBQU9ELFFDbEJmRixDQUFvQixNIiwiZmlsZSI6ImJsYXpvci5leHRlbnNpb25zLmNhbnZhcy5qcyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjbGFzcyBDb250ZXh0TWFuYWdlciB7XG4gIHByaXZhdGUgcmVhZG9ubHkgY29udGV4dHMgPSBuZXcgTWFwPHN0cmluZywgYW55PigpO1xuICBwcml2YXRlIHJlYWRvbmx5IHdlYkdMT2JqZWN0ID0gbmV3IEFycmF5PGFueT4oKTtcbiAgcHJpdmF0ZSByZWFkb25seSBjb250ZXh0TmFtZTogc3RyaW5nO1xuICBwcml2YXRlIHdlYkdMQ29udGV4dCA9IGZhbHNlO1xuICBwcml2YXRlIHJlYWRvbmx5IHByb3RvdHlwZXM6IGFueTtcbiAgcHJpdmF0ZSByZWFkb25seSB3ZWJHTFR5cGVzID0gW1xuICAgIFdlYkdMQnVmZmVyLCBXZWJHTFNoYWRlciwgV2ViR0xQcm9ncmFtLCBXZWJHTEZyYW1lYnVmZmVyLCBXZWJHTFJlbmRlcmJ1ZmZlciwgV2ViR0xUZXh0dXJlLCBXZWJHTFVuaWZvcm1Mb2NhdGlvblxuICBdO1xuXG4gIHB1YmxpYyBjb25zdHJ1Y3Rvcihjb250ZXh0TmFtZTogc3RyaW5nKSB7XG4gICAgdGhpcy5jb250ZXh0TmFtZSA9IGNvbnRleHROYW1lO1xuICAgIGlmIChjb250ZXh0TmFtZSA9PT0gXCIyZFwiKVxuICAgICAgdGhpcy5wcm90b3R5cGVzID0gQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJELnByb3RvdHlwZTtcbiAgICBlbHNlIGlmIChjb250ZXh0TmFtZSA9PT0gXCJ3ZWJnbFwiIHx8IGNvbnRleHROYW1lID09PSBcImV4cGVyaW1lbnRhbC13ZWJnbFwiKSB7XG4gICAgICB0aGlzLnByb3RvdHlwZXMgPSBXZWJHTFJlbmRlcmluZ0NvbnRleHQucHJvdG90eXBlO1xuICAgICAgdGhpcy53ZWJHTENvbnRleHQgPSB0cnVlO1xuICAgIH0gZWxzZVxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIGNvbnRleHQgbmFtZTogJHtjb250ZXh0TmFtZX1gKTtcbiAgfVxuXG4gIHB1YmxpYyBhZGQgPSAoY2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudCwgcGFyYW1ldGVyczogYW55KSA9PiB7XG4gICAgaWYgKCFjYW52YXMpIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBjYW52YXMuJyk7XG4gICAgaWYgKHRoaXMuY29udGV4dHMuZ2V0KGNhbnZhcy5pZCkpIHJldHVybjtcblxuICAgIHZhciBjb250ZXh0O1xuICAgIGlmIChwYXJhbWV0ZXJzKVxuICAgICAgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KHRoaXMuY29udGV4dE5hbWUsIHBhcmFtZXRlcnMpO1xuICAgIGVsc2VcbiAgICAgIGNvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dCh0aGlzLmNvbnRleHROYW1lKTtcblxuICAgIGlmICghY29udGV4dCkgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGNvbnRleHQuJyk7XG5cbiAgICB0aGlzLmNvbnRleHRzLnNldChjYW52YXMuaWQsIGNvbnRleHQpO1xuICB9XG5cbiAgcHVibGljIHJlbW92ZSA9IChjYW52YXM6IEhUTUxDYW52YXNFbGVtZW50KSA9PiB7XG4gICAgdGhpcy5jb250ZXh0cy5kZWxldGUoY2FudmFzLmlkKTtcbiAgfVxuXG4gIHB1YmxpYyBzZXRQcm9wZXJ0eSA9IChjYW52YXM6IEhUTUxDYW52YXNFbGVtZW50LCBwcm9wZXJ0eTogc3RyaW5nLCB2YWx1ZTogYW55KSA9PiB7XG4gICAgY29uc3QgY29udGV4dCA9IHRoaXMuZ2V0Q29udGV4dChjYW52YXMpO1xuICAgIHRoaXMuc2V0UHJvcGVydHlXaXRoQ29udGV4dChjb250ZXh0LCBwcm9wZXJ0eSwgdmFsdWUpO1xuICB9XG5cbiAgcHVibGljIGdldFByb3BlcnR5ID0gKGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQsIHByb3BlcnR5OiBzdHJpbmcpID0+IHtcbiAgICBjb25zdCBjb250ZXh0ID0gdGhpcy5nZXRDb250ZXh0KGNhbnZhcyk7XG4gICAgcmV0dXJuIHRoaXMuc2VyaWFsaXplKGNvbnRleHRbcHJvcGVydHldKTtcbiAgfVxuXG4gIHB1YmxpYyBjYWxsID0gKGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQsIG1ldGhvZDogc3RyaW5nLCBhcmdzOiBhbnkpID0+IHtcbiAgICBjb25zdCBjb250ZXh0ID0gdGhpcy5nZXRDb250ZXh0KGNhbnZhcyk7XG4gICAgcmV0dXJuIHRoaXMuY2FsbFdpdGhDb250ZXh0KGNvbnRleHQsIG1ldGhvZCwgYXJncyk7XG4gIH1cblxuICBwdWJsaWMgY2FsbEJhdGNoID0gKGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQsIGJhdGNoZWRDYWxsczogYW55W11bXSkgPT4ge1xuICAgIGNvbnN0IGNvbnRleHQgPSB0aGlzLmdldENvbnRleHQoY2FudmFzKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJhdGNoZWRDYWxscy5sZW5ndGg7IGkrKykge1xuICAgICAgbGV0IHBhcmFtcyA9IGJhdGNoZWRDYWxsc1tpXS5zbGljZSgyKTtcbiAgICAgIGlmIChiYXRjaGVkQ2FsbHNbaV1bMV0pIHtcbiAgICAgICAgdGhpcy5jYWxsV2l0aENvbnRleHQoY29udGV4dCwgYmF0Y2hlZENhbGxzW2ldWzBdLCBwYXJhbXMpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5zZXRQcm9wZXJ0eVdpdGhDb250ZXh0KFxuICAgICAgICAgIGNvbnRleHQsXG4gICAgICAgICAgYmF0Y2hlZENhbGxzW2ldWzBdLFxuICAgICAgICAgIEFycmF5LmlzQXJyYXkocGFyYW1zKSAmJiBwYXJhbXMubGVuZ3RoID4gMCA/IHBhcmFtc1swXSA6IG51bGwpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgY2FsbFdpdGhDb250ZXh0ID0gKGNvbnRleHQ6IGFueSwgbWV0aG9kOiBzdHJpbmcsIGFyZ3M6IGFueSkgPT4ge1xuICAgIHJldHVybiB0aGlzLnNlcmlhbGl6ZSh0aGlzLnByb3RvdHlwZXNbbWV0aG9kXS5hcHBseShjb250ZXh0LCBhcmdzICE9IHVuZGVmaW5lZCA/IGFyZ3MubWFwKCh2YWx1ZSkgPT4gdGhpcy5kZXNlcmlhbGl6ZShtZXRob2QsIHZhbHVlKSkgOiBbXSkpO1xuICB9XG5cbiAgcHJpdmF0ZSBzZXRQcm9wZXJ0eVdpdGhDb250ZXh0ID0gKGNvbnRleHQ6IGFueSwgcHJvcGVydHk6IHN0cmluZywgdmFsdWU6IGFueSkgPT4ge1xuICAgIGNvbnRleHRbcHJvcGVydHldID0gdGhpcy5kZXNlcmlhbGl6ZShwcm9wZXJ0eSwgdmFsdWUpO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRDb250ZXh0ID0gKGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQpID0+IHtcbiAgICBpZiAoIWNhbnZhcykgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGNhbnZhcy4nKTtcblxuICAgIGNvbnN0IGNvbnRleHQgPSB0aGlzLmNvbnRleHRzLmdldChjYW52YXMuaWQpO1xuICAgIGlmICghY29udGV4dCkgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGNvbnRleHQuJyk7XG5cbiAgICByZXR1cm4gY29udGV4dDtcbiAgfVxuXG4gIHByaXZhdGUgZGVzZXJpYWxpemUgPSAobWV0aG9kOiBzdHJpbmcsIG9iamVjdDogYW55KSA9PiB7XG4gICAgaWYgKCF0aGlzLndlYkdMQ29udGV4dCB8fCBvYmplY3QgPT0gdW5kZWZpbmVkKSByZXR1cm4gb2JqZWN0OyAvL2Rlc2VyaWFsaXphdGlvbiBvbmx5IG5lZWRzIHRvIGhhcHBlbiBmb3Igd2ViR0xcblxuICAgIGlmIChvYmplY3QuaGFzT3duUHJvcGVydHkoXCJ3ZWJHTFR5cGVcIikgJiYgb2JqZWN0Lmhhc093blByb3BlcnR5KFwiaWRcIikpIHtcbiAgICAgIHJldHVybiAodGhpcy53ZWJHTE9iamVjdFtvYmplY3RbXCJpZFwiXV0pO1xuICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShvYmplY3QpICYmICFtZXRob2QuZW5kc1dpdGgoXCJ2XCIpKSB7XG4gICAgICByZXR1cm4gSW50OEFycmF5Lm9mKC4uLihvYmplY3QgYXMgbnVtYmVyW10pKTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZihvYmplY3QpID09PSBcInN0cmluZ1wiICYmIChtZXRob2QgPT09IFwiYnVmZmVyRGF0YVwiIHx8IG1ldGhvZCA9PT0gXCJidWZmZXJTdWJEYXRhXCIpKSB7XG4gICAgICBsZXQgYmluU3RyID0gd2luZG93LmF0b2Iob2JqZWN0KTtcbiAgICAgIGxldCBsZW5ndGggPSBiaW5TdHIubGVuZ3RoO1xuICAgICAgbGV0IGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkobGVuZ3RoKTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBieXRlc1tpXSA9IGJpblN0ci5jaGFyQ29kZUF0KGkpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGJ5dGVzO1xuICAgIH0gZWxzZVxuICAgICAgcmV0dXJuIG9iamVjdDtcbiAgfVxuXG4gIHByaXZhdGUgc2VyaWFsaXplID0gKG9iamVjdDogYW55KSA9PiB7XG4gICAgaWYgKG9iamVjdCBpbnN0YW5jZW9mIFRleHRNZXRyaWNzKSB7XG4gICAgICAgIHJldHVybiB7IHdpZHRoOiBvYmplY3Qud2lkdGggfTtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMud2ViR0xDb250ZXh0IHx8IG9iamVjdCA9PSB1bmRlZmluZWQpIHJldHVybiBvYmplY3Q7IC8vc2VyaWFsaXphdGlvbiBvbmx5IG5lZWRzIHRvIGhhcHBlbiBmb3Igd2ViR0xcblxuICAgIGNvbnN0IHR5cGUgPSB0aGlzLndlYkdMVHlwZXMuZmluZCgodHlwZSkgPT4gb2JqZWN0IGluc3RhbmNlb2YgdHlwZSk7XG4gICAgaWYgKHR5cGUgIT0gdW5kZWZpbmVkKSB7XG4gICAgICBjb25zdCBpZCA9IHRoaXMud2ViR0xPYmplY3QubGVuZ3RoO1xuICAgICAgdGhpcy53ZWJHTE9iamVjdC5wdXNoKG9iamVjdCk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHdlYkdMVHlwZTogdHlwZS5uYW1lLFxuICAgICAgICBpZDogaWRcbiAgICAgICAgfTtcbiAgICB9IGVsc2VcbiAgICAgIHJldHVybiBvYmplY3Q7XG4gIH1cbn1cbiIsImltcG9ydCB7IENvbnRleHRNYW5hZ2VyIH0gZnJvbSAnLi9DYW52YXNDb250ZXh0TWFuYWdlcic7XG5cbm5hbWVzcGFjZSBDYW52YXMge1xuICBjb25zdCBibGF6b3JFeHRlbnNpb25zOiBzdHJpbmcgPSAnQmxhem9yRXh0ZW5zaW9ucyc7XG4gIC8vIGRlZmluZSB3aGF0IHRoaXMgZXh0ZW5zaW9uIGFkZHMgdG8gdGhlIHdpbmRvdyBvYmplY3QgaW5zaWRlIEJsYXpvckV4dGVuc2lvbnNcbiAgY29uc3QgZXh0ZW5zaW9uT2JqZWN0ID0ge1xuICAgIENhbnZhczJkOiBuZXcgQ29udGV4dE1hbmFnZXIoXCIyZFwiKSxcbiAgICBXZWJHTDogbmV3IENvbnRleHRNYW5hZ2VyKFwid2ViZ2xcIilcbiAgfTtcblxuICBleHBvcnQgZnVuY3Rpb24gaW5pdGlhbGl6ZSgpOiB2b2lkIHtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgIXdpbmRvd1tibGF6b3JFeHRlbnNpb25zXSkge1xuICAgICAgLy8gd2hlbiB0aGUgbGlicmFyeSBpcyBsb2FkZWQgaW4gYSBicm93c2VyIHZpYSBhIDxzY3JpcHQ+IGVsZW1lbnQsIG1ha2UgdGhlXG4gICAgICAvLyBmb2xsb3dpbmcgQVBJcyBhdmFpbGFibGUgaW4gZ2xvYmFsIHNjb3BlIGZvciBpbnZvY2F0aW9uIGZyb20gSlNcbiAgICAgIHdpbmRvd1tibGF6b3JFeHRlbnNpb25zXSA9IHtcbiAgICAgICAgLi4uZXh0ZW5zaW9uT2JqZWN0XG4gICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICB3aW5kb3dbYmxhem9yRXh0ZW5zaW9uc10gPSB7XG4gICAgICAgIC4uLndpbmRvd1tibGF6b3JFeHRlbnNpb25zXSxcbiAgICAgICAgLi4uZXh0ZW5zaW9uT2JqZWN0XG4gICAgICB9O1xuICAgIH1cbiAgfVxufVxuXG5DYW52YXMuaW5pdGlhbGl6ZSgpO1xuIiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0aWYoX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSkge1xuXHRcdHJldHVybiBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCIvLyBzdGFydHVwXG4vLyBMb2FkIGVudHJ5IG1vZHVsZVxuX193ZWJwYWNrX3JlcXVpcmVfXyg3ODMpO1xuLy8gVGhpcyBlbnRyeSBtb2R1bGUgdXNlZCAnZXhwb3J0cycgc28gaXQgY2FuJ3QgYmUgaW5saW5lZFxuIl0sInNvdXJjZVJvb3QiOiIifQ==